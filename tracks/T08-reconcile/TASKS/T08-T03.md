# T08-T03: Write roadmap skill

## GOAL
Write the kiln roadmap skill — the `/kiln:roadmap` slash command that reads the approved VISION.md and generates a ROADMAP.md with a dynamic number of phases. Each phase is a title + 1-2 sentence description. The roadmap is intentionally lightweight — it's a sequencing tool, not a planning tool.

## ACCEPTANCE_CRITERIA
- AC-04 (LLM): Dynamic phase count — model determines based on VISION.md scope
- AC-05 (LLM): Lightweight format — titles + 1-2 sentences, no implementation details
- AC-06 (DET): File exists at `skills/kiln-roadmap/kiln-roadmap.md` with valid YAML frontmatter
- AC-12 (LLM): Operator review gate — can reorder, add, remove, adjust phases
- AC-13 (LLM): Output written to `.kiln/ROADMAP.md`

## FILES
- path: skills/kiln-roadmap/kiln-roadmap.md
  action: add
  rationale: The /kiln:roadmap slash command — phase generation from VISION.md

## COMMANDS
- `test -f skills/kiln-roadmap/kiln-roadmap.md` — file exists
- `head -1 skills/kiln-roadmap/kiln-roadmap.md | grep -q "^---"` — has YAML frontmatter
- `wc -l skills/kiln-roadmap/kiln-roadmap.md` — should be ~150-250 lines

## SUMMARY
Create the file `skills/kiln-roadmap/kiln-roadmap.md`. This is a Claude Code skill definition — a markdown document with YAML frontmatter that defines the `/kiln:roadmap` slash command.

**Context for the implementer:** The roadmap is generated AFTER brainstorming (VISION.md approved) and BEFORE any phase planning begins. It breaks the vision into sequenced delivery phases. Each phase becomes a unit of work processed by the `/kiln:track` loop. The roadmap is intentionally LIGHTWEIGHT — it only defines WHAT to build in each phase, not HOW. The HOW comes from per-phase planning (kiln-planner, kiln-codex-planner, kiln-synthesizer). The operator reviews and can modify the roadmap before it's locked.

Start the file with this YAML frontmatter:

```yaml
---
name: kiln-roadmap
description: "Generates a lightweight phase roadmap from approved VISION.md"
user_invocable: true
---
```

Then write heading `# /kiln:roadmap — Roadmap Generation` followed by these sections:

### Section 1: Overview
Write heading `## Overview`. Explain:
- `/kiln:roadmap` reads the approved VISION.md and generates ROADMAP.md
- The roadmap breaks the vision into sequenced delivery phases
- Phase count is DYNAMIC — determined by the model based on the vision's scope
- Format is intentionally lightweight: phase title + 1-2 sentence description
- The operator reviews, reorders, adds/removes phases before approval
- Output: `.kiln/ROADMAP.md`

### Section 2: Prerequisites
Write heading `## Prerequisites`. List:
- `.kiln/VISION.md` must exist and be approved (check STATE.md for brainstorm = complete)
- `.kiln/config.json` must exist
- If VISION.md doesn't exist: instruct operator to run `/kiln:brainstorm` first
- If VISION.md exists but brainstorm not marked complete: warn about unapproved vision

### Section 3: Phase Generation Rules
Write heading `## Phase Generation`. Define:
- Read VISION.md completely
- Identify the must-have features, success criteria, and constraints
- Group related features into phases that can be delivered incrementally
- Phase ordering rules:
  - Foundation/infrastructure first (data models, auth, core utilities)
  - Core features next (the primary value proposition)
  - Secondary features after core works
  - Polish/optimization last
- Each phase must be independently verifiable (E2E testable)
- Each phase should build on previous phases (incremental delivery)
- No phase should be larger than what can be executed in one track loop cycle

### Section 4: Roadmap Format
Write heading `## Roadmap Format`. Define the ROADMAP.md structure:
```markdown
# ROADMAP

## Phase 1: <Title>
<1-2 sentence description of what this phase delivers>

## Phase 2: <Title>
<1-2 sentence description>

...

## Phase N: <Title>
<1-2 sentence description>
```

Rules:
- Titles should be descriptive but short (3-6 words)
- Descriptions focus on WHAT is delivered, not HOW it's built
- No task lists, no file hints, no implementation details
- No time estimates
- Phase numbering is sequential (Phase 1, Phase 2, etc.)

### Section 5: Operator Review
Write heading `## Operator Review`. Define:
- Present the generated roadmap to the operator
- Ask for review: "Here is the proposed roadmap with N phases. You can: reorder phases, add new phases, remove phases, adjust descriptions, or approve as-is."
- On modifications: update ROADMAP.md with operator changes
- On approval: write final ROADMAP.md to `.kiln/ROADMAP.md`, update STATE.md (roadmap = complete)
- ROADMAP.md becomes the phase list for `/kiln:track`

### Section 6: Dynamic Phase Count
Write heading `## Phase Count Guidance`. Provide heuristics:
- Small project (2-4 success criteria): 2-3 phases
- Medium project (5-8 success criteria): 3-5 phases
- Large project (9+ success criteria): 5-8 phases
- These are GUIDELINES, not rules. The model determines based on the actual vision content.
- Too few phases = each phase is too large to verify. Too many phases = overhead from transitions.
- Sweet spot: each phase delivers 1-3 related features that can be E2E tested together.

### Section 7: Output
Write heading `## Output`. Define:
- Write `.kiln/ROADMAP.md` with the approved roadmap
- Update `.kiln/STATE.md`: mark roadmap stage as `complete`, set first phase as `pending`
- Print: "Roadmap approved with N phases. Run /kiln:track to begin phase execution."

Target ~200 lines.

## ESTIMATED_DIFF
~200 lines

## RISKS
- Model may generate too few or too many phases
- Phase boundaries may not align with natural feature boundaries
- Operator may significantly modify the roadmap, invalidating the model's sequencing logic

## ROLLBACK
- git revert <task commit>
