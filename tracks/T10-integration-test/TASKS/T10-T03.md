# T10-T03: Write package validation and README

## GOAL
Validate the npm package: ensure `npm pack` produces a valid tarball with all required files and no leaked dev files. Also create the package README.md with installation instructions.

## ACCEPTANCE_CRITERIA
- AC-07 (DET): `npm pack --dry-run` succeeds
- AC-08 (DET): No dev/build files in package (no .claude/ build agents, no tracks/, no .teams/, no docs/plans/)
- AC-09 (DET): Package contains all required files (agents/, skills/, hooks/, bin/, templates/)
- AC-10 (DET): README.md exists with installation and usage instructions

## FILES
- path: README.md
  action: add
  rationale: Package README for npm
- path: tests/validate-package.sh
  action: add
  rationale: npm package validation script

## COMMANDS
- `test -f README.md` — README exists
- `test -f tests/validate-package.sh` — validation script exists
- `bash tests/validate-package.sh` — package validation passes
- `npm pack --dry-run` — pack succeeds

## SUMMARY
This task has TWO deliverables:

### Deliverable 1: tests/validate-package.sh

Create `tests/validate-package.sh` that validates the npm package contents.

Start with:
```bash
#!/usr/bin/env bash
set -euo pipefail

REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
cd "$REPO_ROOT"
PASS=0
FAIL=0
```

Then implement:

**Check 1: npm pack succeeds**
- Run `npm pack --dry-run 2>&1` and capture output
- Verify exit code 0
- Capture the file list from dry-run output

**Check 2: Required files present in package**
- The dry-run output lists files that would be included
- Check for presence of:
  - `bin/install.js`
  - `package.json`
  - `README.md`
  - `agents/*.md` (at least 11 files)
  - `skills/kiln-core/kiln-core.md` (and other skill dirs)
  - `hooks/hooks.json`
  - `hooks/scripts/*.sh`
  - `templates/*.tmpl` or `templates/*.md`

**Check 3: Dev files NOT in package**
- Verify these are NOT in the pack output:
  - `.claude/` (build agents — these are our tooling, not the product)
  - `tracks/` (build artifacts)
  - `.teams/` (runtime state)
  - `docs/plans/` (design docs)
  - `node_modules/`
  - `.git/`
  - `tests/` (test scripts are dev-only)

**Check 4: package.json validity**
- Verify `name` is "kiln-dev"
- Verify `bin` entry points to install.js
- Verify `files` whitelist exists and includes agents, skills, hooks, bin, templates
- Verify no `dependencies` (zero runtime deps)

**Check 5: npm publish --dry-run** (optional, may require auth)
- Run `npm publish --dry-run 2>&1`
- If it fails due to auth, that's OK — just check pack works
- If it fails due to name conflict, report as warning

### Deliverable 2: README.md

Create `README.md` for the npm package. This is what users see on npmjs.com.

Structure:
```markdown
# kiln-dev

Multi-model orchestration workflow for Claude Code.

## What is Kiln?

Kiln orchestrates multi-model AI workflows for building software with Claude Code. It provides:
- BMAD-style brainstorming with dual-model challenge passes
- Dual-model planning (Claude + GPT) with synthesis
- Automated execution with task sharpening
- End-to-end verification with user journey tests
- Comprehensive code review with stub detection
- Living documentation that stays current

## Quick Start

```bash
npx kiln-dev
```

This installs kiln's agents, skills, and hooks into your project's `.claude/` directory.

## Requirements

- [Claude Code](https://claude.ai/claude-code) installed
- Node.js 18+
- Optional: [Codex CLI](https://github.com/openai/codex) for multi-model mode

## Usage

After installation, use these slash commands in Claude Code:

| Command | Description |
|---------|-------------|
| `/kiln:init` | Initialize a new project (detect tooling, set up .kiln/) |
| `/kiln:brainstorm` | Deep brainstorming session to create VISION.md |
| `/kiln:roadmap` | Generate implementation phases from vision |
| `/kiln:track` | Execute phases (plan → build → verify → review → reconcile) |
| `/kiln:status` | Check current project progress |
| `/kiln:quick` | Single-pass mode for smaller tasks |

## How It Works

1. **Brainstorm** — Interactive session explores your problem space, produces VISION.md
2. **Roadmap** — Breaks vision into sequenced delivery phases
3. **Per Phase:**
   - Plan (dual-model) → Validate → Execute → E2E Test → Review → Reconcile docs
4. **Final E2E** — Cross-cutting integration tests across all phases

## Model Modes

- **Multi-model** (requires Codex CLI): Uses Claude + GPT for challenge passes, dual planning, and implementation
- **Claude-only** (default): Full pipeline using Claude models only

## License

MIT
```

Target: ~100 lines for validate-package.sh, ~80 lines for README.md.

## ESTIMATED_DIFF
~180 lines total

## RISKS
- npm pack output format may vary between npm versions
- Package name availability on npm registry
- README may need updates as features evolve

## ROLLBACK
- git revert <task commit>
